!function(a,b){"object"==typeof exports?module.exports=b("undefined"!=typeof global?global:a):"function"==typeof define&&define.amd?define(function(){return b(a)}):b(a)}(this,function(a){return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a){return function(b){if(a._status===l.unresolved){var c=a._rejectReactions;return a._result=b,a._rejectReactions=void 0,a._resolveReactions=void 0,a._status=l.rejected,i(c,b)}}}function e(a){return function(b){if(a._status===l.unresolved){var c=a._resolveReactions;return a._result=b,a._rejectReactions=void 0,a._resolveReactions=void 0,a._status=l.resolved,i(c,b)}}}function f(a,b,c){return function(d){if(d===a){var e=new TypeError("Handler result cannot be same promise as input");return c.call(void 0,e)}var f=a.constructor,h=g(f);return j(d,h)?n.invoke(h.promise,"then",[b,c]):b.call(void 0,d)}}function g(a){if(!n.isConstructor(a))throw new TypeError("newPromiseCapability only accept a constructor as argument");var b={promise:void 0,resolve:void 0,reject:void 0};if(b.promise=new a(function(a,c){b.resolve=a,b.reject=c}),!n.isCallable(b.resolve))throw new TypeError("Given constructor type does not provide an acceptable resolve function");if(!n.isCallable(b.reject))throw new TypeError("Given constructor type does not provide an acceptable reject function");return b}function h(a){return n.isObject(a)&&!n.isUndefined(a._status)}function i(a,b){for(var c,d=0,e=a.length;e>d;d++)c=a[d],m.enqueue(k,[c,b])}function j(a,b){try{if(n.isObject(a)&&n.isCallable(a.then))return a.then.call(a,b.resolve,b.reject),!0}catch(c){return b.reject.call(null,c),!0}return!1}function k(a,b){if(!a||!a.capability||!a.handler)throw new TypeError("PromiseReactionTask take a promise reaction record as first argument");var c,d=a.capability,e=a.handler;try{c=e.call(void 0,b)}catch(f){return d.reject.call(void 0,f)}if(c===d.promise){var g=new TypeError("Handler result cannot be same promise as input");return d.reject.call(void 0,g)}return j(c,d)?void 0:d.resolve.call(void 0,c)}var l=a("./status"),m=a("./tasks"),n=a("./utils");c.createRejectFunction=d,c.createResolveFunction=e,c.createResolutionHandlerFunction=f,c.newPromiseCapability=g,c.isPromise=h,c.triggerPromiseReaction=i,c.updatePromiseFromPotentialThenable=j,c.PromiseReactionTask=k},{"./status":3,"./tasks":4,"./utils":5}],2:[function(a,b,c){"use strict";var d=a("./abstract"),e=a("./status"),f=a("./tasks"),g=a("./utils"),h=function(){function a(b){if(this._status=e.waiting,!g.isCallable(b))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof a))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._status=e.unresolved,this._resolveReactions=[],this._rejectReactions=[];var c=d.createResolveFunction(this),f=d.createRejectFunction(this);try{b(c,f)}catch(h){f.call(void 0,h)}}return a.prototype.then=function(a,b){var c=this,h=this.constructor,i=d.newPromiseCapability(h);g.isCallable(b)||(b=g.thrower),g.isCallable(a)||(a=g.identity);var j={capability:i,handler:d.createResolutionHandlerFunction(c,a,b)},k={capability:i,handler:b};return this._status===e.unresolved?(this._resolveReactions.push(j),this._rejectReactions.push(k)):this._status===e.resolved?f.enqueue(d.PromiseReactionTask,[j,c._result]):this._status===e.rejected&&f.enqueue(d.PromiseReactionTask,[k,c._result]),i.promise},a.prototype["catch"]=function(a){return this.then(void 0,a)},a.resolve=function(a){var b=this,c=d.newPromiseCapability(b);return c.resolve.call(void 0,a),c.promise},a.reject=function(a){var b=this,c=d.newPromiseCapability(b);return c.reject.call(void 0,a),c.promise},a.all=function(a){function b(a){return function(b){h[a]=b,i--,0===i&&f.resolve.call(void 0,h)}}var c,e=this,f=d.newPromiseCapability(e),h=[],i=0,j=a.length,k=0;if(0===j)return f.resolve.call(void 0,h),f.promise;for(;j>k;k++){c=a[k];try{c=g.invoke(e,"resolve",[c]),g.invoke(c,"then",[b(k),f.reject])}catch(l){return f.reject.call(void 0,l),f.promise}i++}return f.promise},a.race=function(a){for(var b,c=this,e=d.newPromiseCapability(c),f=0,h=a.length;h>f;f++){b=a[f];try{b=g.invoke(c,"resolve",[b]),g.invoke(b,"then",[e.resolve,e.reject])}catch(i){return e.reject.call(void 0,i),e.promise}}return e.promise},a}();b.exports=h},{"./abstract":1,"./status":3,"./tasks":4,"./utils":5}],3:[function(a,b,c){"use strict";c.waiting=void 0,c.unresolved="unresolved",c.resolved="has-resolution",c.rejected="has-rejection"},{}],4:[function(a,b,c){"use strict";function d(){for(var a=0;h>a;a+=2){var b=i[a],c=i[a+1];b.apply(null,c),i[a]=g,i[a+1]=g}h=0}function e(){for(var a=0;h>a;a++)i[a]=g;h=0}function f(a,b){i[h]=a,i[h+1]=b,h+=2,2===h&&j()}var g,h=0,i=new Array(1e3),j=function(){if("undefined"!=typeof process&&"[object process]"==={}.toString.call(process))return global.setImmediate?function(){global.setImmediate(d)}:function(){process.nextTick(d)};if("undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel){var a=new MessageChannel;return a.port1.onmessage=d,function(){a.port2.postMessage(0)}}var b="undefined"!=typeof window?window:{},c=function(){if(b.postMessage&&!b.importScripts){var a=!0,c=b.onmessage;return b.onmessage=function(){a=!1},b.postMessage("","*"),b.onmessage=c,a}};if(b.MutationObserver||b.WebKitMutationObserver){b.MutationObserver=b.MutationObserver||b.WebKitMutationObserver;var e=0,f=new b.MutationObserver(d),g=document.createTextNode("");return f.observe(g,{characterData:!0}),function(){g.data=e=++e%2}}if(c()){var h="setImmediate$"+Math.random()+"$",i=function(a){a.source===b&&"string"==typeof a.data&&0===a.data.indexOf(h)&&d()};return b.addEventListener?b.addEventListener("message",i,!1):b.attachEvent("onmessage",i),function(){b.postMessage(h+1e3*Math.random(),"*")}}return function(){setTimeout(d,1)}}();c.clear=e,c.enqueue=f},{}],5:[function(a,b,c){"use strict";function d(a){return"function"==typeof a}function e(a){return"object"==typeof a&&null!==a}function f(a){return d(a)&&a.prototype&&a.prototype.constructor===a}function g(a){return"undefined"==typeof a}function h(a,b){return b in a}function i(a,b,c){if(void 0===c&&(c=[]),!h(a,b)||!d(a[b]))throw new TypeError("Object has no "+b+" function");return a[b].apply(a,c)}function j(a){return a}function k(a){throw a instanceof Error||(a=new Error(a)),a}c.isCallable=d,c.isObject=e,c.isConstructor=f,c.isUndefined=g,c.hasProperty=h,c.invoke=i,c.identity=j,c.thrower=k},{}],6:[function(b,c,d){function e(a){var b;return new a(function(a){b=a}),"function"==typeof b}function f(a){return a&&"resolve"in a&&"reject"in a&&"all"in a&&"race"in a&&e(a)}f(a.Promise)||(a.Promise=b("./class"))},{"./class":2}]},{},[6]),a.Promise});